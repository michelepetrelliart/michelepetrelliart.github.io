<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="robots" content="noindex, nofollow">
<title>...</title>
<style>body { background: #000; margin: 0; }</style>

<meta http-equiv="refresh" content="2; url=https://michelepetrelliart.github.io/pages_static/all.html">

<script>
(function() {
    const links = {
        'patreon': "https://www.patreon.com/c/michelepetrelliart",
        'substack': "https://recordsnode.substack.com"
    };
    const githubHome = "https://michelepetrelliart.github.io/pages_static/all.html";

    const urlParams = new URLSearchParams(window.location.search);
    const destinationKey = urlParams.get('to');

    // Funzione per gestire il redirect con tracciamento
    function secureRedirect(url, type) {
        if (window.clicky) {
            // Logga l'evento su Clicky: 'In' per stranieri, 'Out' per italiani/rimbalzi
            clicky.log(window.location.href, "RD: " + type, "click");

            // Aspettiamo un battito di ciglia (100ms) per l'invio del dato
            setTimeout(function() {
                window.location.replace(url);
            }, 100);
        } else {
            // Se Clicky Ã¨ bloccato o non caricato, via subito
            window.location.replace(url);
        }
    }

    if (!destinationKey || !links[destinationKey]) {
        secureRedirect(githubHome, "INVALID_KEY");
        return;
    }

    // 1. Controllo Lingue
    const userLangs = navigator.languages || [navigator.language || navigator.userLanguage];
    const hasItalian = userLangs.some(lang => lang.toLowerCase().startsWith('it'));

    // 2. Controllo Fuso Orario
    const isItalyTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone === 'Europe/Rome';

    if (hasItalian || isItalyTimezone) {
        // Italiano beccato: lo mandiamo al catalogo statico
        secureRedirect(githubHome, "LOCAL_BOUNCE");
    } else {
        // Straniero pulito: va alla destinazione scelta
        secureRedirect(links[destinationKey], "INT_ACCESS_" + destinationKey.toUpperCase());
    }
})();
</script>
</head>
<body></body>
</html>
