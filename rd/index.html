<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="robots" content="noindex, nofollow">
<title>...</title>
<style>body { background: #000; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; }</style>

<script src="//static.getclicky.com/js"></script>
<script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101499862);</script>

<script>
(function() {
    const links = {
        'patreon': "https://www.patreon.com/c/michelepetrelliart",
        'substack': "https://recordsnode.substack.com"
    };
    const githubHome = "https://michelepetrelliart.github.io/pages_static/all.html";

    const urlParams = new URLSearchParams(window.location.search);
    const toParam = urlParams.get('to');
    const refParam = urlParams.get('ref');

    const isItalian = (navigator.languages || [navigator.language]).some(l => l.toLowerCase().startsWith('it')) ||
                      Intl.DateTimeFormat().resolvedOptions().timeZone === 'Europe/Rome';

    let target, label;

    if (isItalian) {
        target = githubHome;
        label = "RD_ITALY_BOUNCE";
    } else {
        const destination = toParam || 'patreon';
        target = links[destination] || githubHome;
        label = "RD_INT_" + destination.toUpperCase();
    }

    if (refParam) {
        label += "_" + refParam.toUpperCase();
    }

    function finalTest() {
        if (window.clicky) {
            // Se c'è un refParam, diciamo a Clicky che il referrer è quello
            if (refParam) {
                clicky.source = refParam.toLowerCase() + ".com";
            }
            clicky.log(window.location.href, label, "pageview");
        }

        setTimeout(function() {
            window.location.replace(target);
        }, 500);
    }

    window.onload = finalTest;
})();
</script>
</head>
<body>
</body>
</html>
